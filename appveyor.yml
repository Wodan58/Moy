version: 1.0.0.{build}

cache:
  - win_flex_bison-latest.zip

environment:
  WINFLEXBISON_ARCHIVE: win_flex_bison-latest.zip

install:
  # install flex/bison
  # appveyor DownloadFile "http://d.7-zip.org/7z1701.exe"
  - if not exist %WINFLEXBISON_ARCHIVE% appveyor DownloadFile "https://sourceforge.net/projects/winflexbison/files/%WINFLEXBISON_ARCHIVE%"
  - 7z x -y -owinflexbison\ %WINFLEXBISON_ARCHIVE%
  - set Path=.\winflexbison\%Path%
  - win_flex --version
  - win_bison --version

build_script:
  - call "C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" x86
  - git clone https://github.com/ivmai/bdwgc.git
  - cmake -G "NMake Makefiles"
  - cmake --build . --config Release
