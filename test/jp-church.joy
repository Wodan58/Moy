%INCLUDE stdlib.joy

DEFINE
swoncat == swap concat ;
sip == dupd dip ;
dipd == [ dip ] cons dip ;
Qsucc == [ [ dup [ i ] dip ] dip i ] cons ;
Qpow == [ [ [ [ Q1 i ] ] dip [ Qmul i ] cons [ cons ] cons ] dip i i ] cons cons ;
Qmul == [ [ [ [ Q0 i ] ] dip [ Qadd i ] cons [ cons ] cons ] dip i i ] cons cons ;
Qadd == [ [ [ Qsucc i ] cons ] swap i i ] cons cons ;
Q3 == Q2 Qsucc ;
Q2 == Q1 Qsucc ;
Q1 == Q0 Qsucc ;
Q0 == [ pop ] ;
Peano == 0 [ succ ] ;
Lists == [ ] [ [ i ] swoncat ] ;
Doublings == 1 [ 2 * ] ;
Ctrue == pop i ;
Csucc == [ dup dip ] dip i ;
Cpow == [ [ cons ] cons ] dip i i ;
Cor == [ [ Ctrue ] ] dipd i ;
Comparison == 2 3 [ < ] [ > ] ;
Cnot == swapd i ;
Cmul == [ cons ] dip i ;
Cifte == rolldown i ;
Cfalse == popd i ;
Ceq0 == [ [ Ctrue ] [ pop [ Cfalse ] ] ] dip i i ;
Ccons == [ i ] ;
Ccdr == [ Cfalse ] swap i ;
Ccar == [ Ctrue ] swap i ;
Cand == [ [ Cfalse ] ] dip i ;
Cadd == [ sip ] dip i ;
C3 == [ C2 ] Csucc ;
C2 == [ C1 ] Csucc ;
C1 == [ C0 ] Csucc ;
C0 == pop ;
Boole == [ "Yes, yes" ] [ "No, no" ] ;
END

0 setautoput .
Peano C0 put_int nl .
Peano [ C0 ] Csucc put_int nl .
Peano [ [ C0 ] Csucc ] Csucc put_int nl .
Peano [ [ [ C0 ] Csucc ] Csucc ] Csucc put_int nl .
Peano C0 put_int nl .
Peano C1 put_int nl .
Peano C2 put_int nl .
Peano C3 put_int nl .
Doublings C0 put_int nl .
Doublings C1 put_int nl .
Doublings C2 put_int nl .
Doublings C3 put_int nl .
Lists C0 "()" put_list nl .
Lists C1 "(y)" put_list nl .
Lists C2 "(yy)" put_list nl .
Lists C3 "(yyy)" put_list nl .
Peano [ C2 ] [ C3 ] Cadd put_int nl .
Peano [ C2 ] [ C3 ] Cmul put_int nl .
Peano [ C2 ] [ C3 ] Cpow put_int nl .
Doublings [ C2 ] [ C3 ] Cadd put_int nl .
Doublings [ C2 ] [ C3 ] Cmul put_int nl .
Doublings [ C2 ] [ C3 ] Cpow put_int nl .
Peano [ [ [ [ [ C3 ] Csucc ] [ C2 ] Cadd ] [ C3 ] Cmul ] Csucc ] [ C2 ] Cadd put_int nl .
Peano [ [ [ [ [ C3 ] Csucc ] [ C2 ] Cadd ] [ C3 ] Cmul ] Csucc ] [ C2 ] Cadd 3
succ 2 + 3 * succ 2 + = put_bool nl .
Peano [ [ [ [ C2 ] [ C3 ] Cmul ] [ C2 ] Cpow ] [ [ C2 ] [ [ C1 ] Csucc ] Cmul ]
Cadd ] [ C2 ] Cadd put_int nl .
Peano Q0 i put_int nl .
Peano Q0 Qsucc i put_int nl .
Peano Q0 Qsucc Qsucc i put_int nl .
Peano Q0 i put_int nl .
Peano Q1 i put_int nl .
Peano Q2 i put_int nl .
Peano Q3 i put_int nl .
Q0 "(y)" put_list nl .
Q1 "((y)(y(y)y)yy)" put_list nl .
Q2 "(((y)(y(y)y)yy)(y(y)y)yy)" put_list nl .
Q3 "((((y)(y(y)y)yy)(y(y)y)yy)(y(y)y)yy)" put_list nl .
Peano Q2 Q3 Qadd i put_int nl .
Peano Q2 Q3 Qmul i put_int nl .
Peano Q2 Q3 Qpow i put_int nl .
Q2 Q3 Qadd "((((y)(y(y)y)yy)(y(y)y)yy)((((y)(y(y)y)yy)(y(y)y)yy)(y(y)y)yy)((yy)y)yyy)"
put_list nl .
Q2 Q3 Qmul "((((y)(y(y)y)yy)(y(y)y)yy)((((y)(y(y)y)yy)(y(y)y)yy)(y(y)y)yy)(((yy))y(yy)y(y)y)yyy)" put_list nl .
Q2 Q3 Qpow "((((y)(y(y)y)yy)(y(y)y)yy)((((y)(y(y)y)yy)(y(y)y)yy)(y(y)y)yy)(((yy))y(yy)y(y)y)yyy)" put_list nl .
Peano Q3 Qsucc Q2 Qadd Q3 Qmul Qsucc Q2 Qadd i put_int nl .
Peano Q3 Qsucc Q2 Qadd Q3 Qmul Qsucc Q2 Qadd i 3 succ 2 + 3 * succ 2 + = put_bool nl .
Boole Ctrue put_str nl .
Boole Cfalse put_str nl .
Comparison Ctrue put_bool nl .
Comparison Cfalse put_bool nl .
Boole [ Ctrue ] Cnot put_str nl .
Boole [ Cfalse ] Cnot put_str nl .
Comparison [ [ Ctrue ] Cnot ] Cnot put_bool nl .
Comparison [ [ Cfalse ] Cnot ] Cnot put_bool nl .
Boole [ Ctrue ] [ Ctrue ] Cor put_str nl .
Boole [ Ctrue ] [ Cfalse ] Cor put_str nl .
Boole [ Cfalse ] [ Ctrue ] Cor put_str nl .
Boole [ Cfalse ] [ Cfalse ] Cor put_str nl .
Boole [ Ctrue ] [ Ctrue ] Cand put_str nl .
Boole [ Ctrue ] [ Cfalse ] Cand put_str nl .
Boole [ Cfalse ] [ Ctrue ] Cand put_str nl .
Boole [ Cfalse ] [ Cfalse ] Cand put_str nl .
Boole [ C0 ] Ceq0 put_str nl .
Boole [ C1 ] Ceq0 put_str nl .
Boole [ C2 ] Ceq0 put_str nl .
Boole [ [ C0 ] Ceq0 ] [ [ [ C2 ] Csucc ] Ceq0 ] Cor put_str nl .
Boole [ [ C0 ] Ceq0 ] [ [ [ C2 ] Csucc ] Ceq0 ] Cand put_str nl .
Peano [ [ C0 ] Ceq0 ] [ C2 ] [ C3 ] Cifte put_int nl .
Peano [ [ C1 ] Ceq0 ] [ C2 ] [ C3 ] Cifte put_int nl .
Peano [ [ [ C0 ] Ceq0 ] Cnot ] [ C2 ] [ C3 ] Cifte put_int nl .
Peano [ [ [ C1 ] Ceq0 ] Cnot ] [ C2 ] [ C3 ] Cifte put_int nl .
Peano [ Ctrue ] [ [ Ctrue ] [ C0 ] [ C1 ] Cifte ] [ [ Ctrue ] [ C2 ] [ C3 ]
Cifte ] Cifte put_int nl .
Peano [ Ctrue ] [ [ Cfalse ] [ C0 ] [ C1 ] Cifte ] [ [ Cfalse ] [ C2 ] [ C3 ]
Cifte ] Cifte put_int nl .
Peano [ Cfalse ] [ [ Ctrue ] [ C0 ] [ C1 ] Cifte ] [ [ Ctrue ] [ C2 ] [ C3 ]
Cifte ] Cifte put_int nl .
Peano [ Cfalse ] [ [ Cfalse ] [ C0 ] [ C1 ] Cifte ] [ [ Cfalse ] [ C2 ] [ C3 ]
Cifte ] Cifte put_int nl .
Peano [ C0 ] [ C1 ] Ccons Ccar put_int nl .
Peano [ C0 ] [ C1 ] Ccons Ccdr put_int nl .
Peano [ [ C0 ] [ C1 ] Ccons Ccar ] [ [ C2 ] [ C3 ] Ccons Ccar ] Ccons Ccar put_int nl .
Peano [ [ C0 ] [ C1 ] Ccons Ccdr ] [ [ C2 ] [ C3 ] Ccons Ccdr ] Ccons Ccar put_int nl .
Peano [ [ C0 ] [ C1 ] Ccons Ccar ] [ [ C2 ] [ C3 ] Ccons Ccar ] Ccons Ccdr put_int nl .
Peano [ [ C0 ] [ C1 ] Ccons Ccdr ] [ [ C2 ] [ C3 ] Ccons Ccdr ] Ccons Ccdr put_int nl .
Peano [ C2 ] [ C3 ] Cadd put_int nl .
Peano [ C2 ] [ C3 ] Cmul put_int nl .
Peano [ C2 ] [ C3 ] Cpow put_int nl .
Doublings [ C2 ] [ C3 ] Cadd put_int nl .
Doublings [ C2 ] [ C3 ] Cmul put_int nl .
Doublings [ C2 ] [ C3 ] Cpow put_int nl .
Peano [ [ [ [ [ C3 ] Csucc ] [ C2 ] Cadd ] [ C3 ] Cmul ] Csucc ] [ C2 ] Cadd put_int nl .
Peano [ [ [ [ [ C3 ] Csucc ] [ C2 ] Cadd ] [ C3 ] Cmul ] Csucc ] [ C2 ] Cadd 3
succ 2 + 3 * succ 2 + = put_bool nl .
