%INCLUDE stdlib.joy

DEFINE
swoncat == swap concat ;
P3 == [ [ [ 1 2 ] [ 3 4 ] [ 5 ] [ ] ] [ [ dup * ] map ] map ] ;
P2 == [ [ 1 2 3 ] [ dup * ] map ] ;
P1 == [ 2 3 + dup * ] ;
P0 == [ ] .
HIDE
j2f-r == [ dup list ] [ [ [ swons ] swoncat ] dip [ j2f-r ] step [ ] swons ]
	 [ [ ] cons [ swoncat ] cons swoncat ] ifte ;
j2f-f == [ dup list ] [ [ [ [ ] ] concat ] dip [ j2f-f ] step [ [ ] cons
	 concat ] concat ] [ [ ] cons [ concat ] cons concat ] ifte ;
IN
j2f-reverse == [ ] swap [ j2f-r ] step [ ] swons ;
j2f-forwards == [ [ ] ] swap [ j2f-f ] step ;
END

0 setautoput .
P0 "()" put_list nl .
P0 j2f-forwards "(())" put_list nl .
P0 j2f-forwards i "()" put_list nl .
P1 "(iiyyy)" put_list nl .
P1 j2f-forwards "(()(i)y(i)y(y)y(y)y(y)y)" put_list nl .
P1 j2f-forwards i "(iiyyy)" put_list nl .
P1 j2f-forwards i i put_int nl .
P2 "((iii)(yy)y)" put_list nl .
P2 j2f-forwards "(()()(i)y(i)y(i)y()yy()(y)y(y)y()yy(y)y)" put_list nl.
P2 j2f-forwards i "((iii)(yy)y)" put_list nl .
P2 j2f-forwards i i "(iii)" put_list nl .
P3 "(((ii)(ii)(i)())((yy)y)y)" put_list nl .
P3 j2f-forwards "(()()()(i)y(i)y()yy()(i)y(i)y()yy()(i)y()yy()()yy()yy()()(y)y(y)y()yy(y)y()yy(y)y)" put_list nl .
P3 j2f-forwards i "(((ii)(ii)(i)())((yy)y)y)" put_list nl .
P3 j2f-forwards i i "((ii)(ii)(i)())" put_list nl .
P0 "()" put_list nl .
P0 j2f-reverse "(())" put_list nl .
P0 j2f-reverse i "()" put_list nl .
P1 "(iiyyy)" put_list nl .
P1 j2f-reverse "(()(y)y(y)y(y)y(i)y(i)y)" put_list nl .
P1 j2f-reverse i "(iiyyy)" put_list nl .
P1 j2f-reverse i i put_int nl .
P2 "((iii)(yy)y)" put_list nl .
P2 j2f-reverse "(()(y)y()(y)y(y)yy()(i)y(i)y(i)yy)" put_list nl .
P2 j2f-reverse i "((iii)(yy)y)" put_list nl .
P2 j2f-reverse i i "(iii)" put_list nl .
P3 "(((ii)(ii)(i)())((yy)y)y)" put_list nl .
P3 j2f-reverse "(()(y)y()(y)y()(y)y(y)yyy()()y()(i)yy()(i)y(i)yy()(i)y(i)yyy)" put_list nl .
P3 j2f-reverse i "(((ii)(ii)(i)())((yy)y)y)" put_list nl .
P3 j2f-reverse i i "((ii)(ii)(i)())" put_list nl .
P3 j2f-forwards j2f-reverse "(()(y)y()(y)yy(y)y(y)y()y(y)y()(y)yy(y)y(y)y()y(y)y()(y)yy(y)y()(y)yy()y()y(y)y(y)y()y(y)y(y)y()y()y(y)y(y)y()y(y)y()(i)yy()y(y)y(y)y()y(y)y()(i)yy(y)y()(i)yy()y(y)y(y)y()y(y)y()(i)yy(y)y()(i)yy()y()y()y)" put_list nl .
P3 j2f-forwards j2f-reverse i "(()()()(i)y(i)y()yy()(i)y(i)y()yy()(i)y()yy()()yy()yy()()(y)y(y)y()yy(y)y()yy(y)y)" put_list nl .
P3 j2f-forwards j2f-reverse i i "(((ii)(ii)(i)())((yy)y)y)" put_list nl .
P3 j2f-forwards j2f-reverse i i i "((ii)(ii)(i)())" put_list nl .
