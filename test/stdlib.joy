(*
    Print a list according to a descriptive string.
*)
LIBRA
ps == "stack: " putchars stack put '\n putch ;
nl == '\n putch ;
space == 32 putch ;
get_data == [ dup null ] [ ] [ unswons ] ifte ;
put_list == 0 rollup
[ dup null_str not ]                                 # as long as the string is not empty
[ uncons_str                                         # read the first character
[ [ [ '[ ]
    [ '] pop ]
    [ '( "[ " putchars ]
    [ ') "] " putchars pop ]
    [ 's putchars space ]
    [ 't put_str ]
    [ 'i put_int ]
    [ 'd put_dbl ]
    [ 'c put_char ]
    [ 'b put_bool ]
    [ 'y put_sym ]
    [ 'z put_set ]
    [ ]
  ] case
  get_data
] dip
] while pop pop ;                                    # continue
put_list_int == "[ " putchars [ put_int ] step "]" putchars ;
put_list_str == "[ " putchars [ put_str ] step "]" putchars ;
put_list_sym == "[ " putchars [ put_sym ] step "]" putchars ;
put_list_dbl == "[ " putchars [ put_dbl ] step "]" putchars ;
put_list_chr == "[ " putchars [ putch space ] step "]" putchars ;
put_list_char == "[ " putchars [ put_char ] step "]" putchars ;
put_list_set == "[ " putchars [ put_set ] step "]" putchars ;
put_list_bool == "[ " putchars [ put_bool ] step "]" putchars ;
.
